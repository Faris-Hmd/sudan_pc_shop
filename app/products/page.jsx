import Link from "next/link";
import SearchForm from "../comp/SearchForm";
import EmptyMuted from "../comp/empty";
import { getProducts } from "../data/products";
import Image from "next/image";
export const metadata = {
  title: "SPS | products Sesrch",
  description: "Generated by create next app",
};

export default async function Home({ searchParams }) {
  const { search_word } = await searchParams;
  let products = [];
  console.log(search_word);

  if (search_word !== undefined) {
    products = await getProducts(search_word, 6);
  }

  return (
    <>
      <SearchForm />

      <div className="p-1 flex justify-around flex-wrap gap-1">
        {products && products?.length > 0 ? (
          products.map((row) => (
            <div
              className="w-full flex items-center gap-2 bg-white shadow border rounded overflow-hidden"
              key={row.id}
            >
              <Link href={`products/${row.id}`} className="relative">
                <div className="h-20 w-20 ms-auto relative bg-amber-300">
                  <Image
                    sizes="100"
                    fill
                    src={row.p_imgs[0].url}
                    alt="Product Image"
                    // className="ms-auto"
                  />
                </div>
              </Link>
              <div className="p-1 ">
                <div className="name text-sm font-bold">{row.p_name}</div>
                <span className="cost text-xs  text-green-600">
                  {row.p_cost} SDG
                </span>
                <span className="category text-xs text-gray-500">
                  {" "}
                  | {row.p_cat}
                </span>
              </div>
            </div>
          ))
        ) : (
          <EmptyMuted />
        )}
      </div>
    </>
  );
}
